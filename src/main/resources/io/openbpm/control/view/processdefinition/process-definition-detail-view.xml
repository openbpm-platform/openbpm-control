<!--
  ~ Copyright (c) Haulmont 2024. All Rights Reserved.
  ~ Use is subject to license terms.
  -->

<view xmlns="http://jmix.io/schema/flowui/view"
      title="msg://processDefinitionDetail.title">
    <data readOnly="true">
        <instance id="processDefinitionDataDc"
                  class="io.openbpm.control.entity.processdefinition.ProcessDefinitionData">
            <loader id="processDefinitionDataDl"/>
        </instance>
        <collection id="processInstanceDataDc"
                    class="io.openbpm.control.entity.processinstance.RuntimeProcessInstanceData">
            <loader id="processInstanceDataDl"/>
        </collection>
        <instance id="processInstanceFilterDc" class="io.openbpm.control.entity.filter.ProcessInstanceFilter">
            <loader id="processInstanceFilterDl"/>
            <fetchPlan extends="_base"/>
        </instance>
    </data>
    <actions>
        <action id="closeAction" type="detail_close" text="msg:///actions.Close"/>
    </actions>
    <layout padding="false" spacing="false" expand="box" height="100%">
        <hbox id="box" width="100%" spacing="false" classNames="overflow-hidden">
            <split id="rootBox" orientation="VERTICAL" splitterPosition="50" themeNames="splitter-spacing" width="100%"
                   height="100%">
                <vbox width="100%" height="100%" themeNames="spacing-s" padding="false" classNames="pt-s pb-s relative">
                    <hbox padding="false" themeNames="spacing-l" width="100%" alignItems="CENTER"
                          classNames="pl-s pr-s">
                        <comboBox id="versionComboBox" required="true" width="8em" label="msg://io.openbpm.control.entity.processdefinition/ProcessDefinitionData.version"
                                  classNames="pt-0"/>
                        <textField id="versionTagField" property="versionTag" dataContainer="processDefinitionDataDc" readOnly="true" label="msg://io.openbpm.control.entity.processdefinition/ProcessDefinitionData.versionTag"
                                   classNames="pt-0"/>
                        <vbox themeNames="spacing-xs" padding="false" width="auto" classNames="ml-auto p-xs">
                            <hbox padding="false" classNames="text-s" alignItems="CENTER"
                                  themeNames="spacing-xs">
                                <icon icon="BOLT" classNames="text-s text-secondary icon-s" size="1em"/>
                                <span text="msg://spanText" classNames="text-s text-secondary font-semibold whitespace-nowrap"/>
                            </hbox>
                            <span id="allVersionsInstancesCountSpan" classNames="font-bold text-m"/>
                        </vbox>
                    </hbox>
                    <hbox id="diagramBox" height="100%" classNames="process-details-diagram-box" width="100%">
                        <fragment id="viewerFragment" class="io.openbpm.uikit.fragment.bpmnviewer.BpmnViewerFragment"/>
                    </hbox>
                </vbox>
                <div classNames="p-s">
                    <tabSheet id="tabsheet" width="100%" height="100%" themeNames="hide-scroll-buttons bordered"
                              classNames="box-border flex-grow">
                        <tab id="processInstancesTab" label="msg://processInstancesTab.defaultLabel">
                            <div height="100%" width="100%">
                                <fragment class="io.openbpm.control.view.processdefinition.ProcessInstancesFragment"
                                          id="processInstancesFragment"/>
                            </div>
                        </tab>
                        <tab id="bpmnXmlTab" label="msg://bpmnXmlTab" enabled="true">
                            <codeEditor mode="XML" readOnly="true" id="bpmnXmlEditor" width="100%" height="100%"
                                        css="padding:0"/>
                        </tab>
                    </tabSheet>
                </div>
            </split>
            <fragment id="generalPanel" class="io.openbpm.control.view.processdefinition.GeneralPanelFragment"/>
        </hbox>

        <hbox id="windowActions" width="100%" justifyContent="START"
              classNames="sticky-buttons-bottom-panel pl-s pr-s pb-s pt-s">
            <button id="closeAction" action="closeAction" alignSelf="START"/>
        </hbox>
    </layout>
</view>